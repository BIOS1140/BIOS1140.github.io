---
title: "Exercise 1 - Introduction to R"
author: "Even Sletteng Garvang"
output: 
  bookdown::html_document2:
    toc: true
    toc_float: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

```{=html}
<style type="text/css">

.subtitle { font-size: 24px; }

.author { font-size: 16px; 
  font-style: italic;
  }

.date { font-size: 16px; 
  font-style: italic;
  }

h1 { font-size: 28px; }

h2 { font-size: 24px; }

h3 { font-size: 20px; }

div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}

div.green { background-color:#e4fce3; border-radius: 5px; padding: 20px;}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      fig.width = 5, 
                      fig.asp = 3/4, 
                      comment = "#>",
                      warning = FALSE,
                      message = FALSE)
```

::: {.green}
**Important concept**

Green boxes summarizes important concepts from the text.
:::

::: {.blue}
**Additional info**

Blue boxes contain small tips and additional information for those that are interested. What's in these is hopefully useful, but not mandatory. Feel free to skip these if you want.
:::

**Text in bold contains small exercises to do on your own throughout the tutorial.**

# Start using R!

## Install R and Rstudio

## Getting familiar with R and the console

### R as a calculator

In the bottom left you will see a `>` where you can input text. This is called the console, and you can directly interact with R through this. Try inputting a number, or any calculation you can think of, and then press `enter`. For example:

```{r, eval = FALSE}
4
4+3
11-5
5*2
3/2
10^2
```

You will see that if you input a single number, R will return that same number to you. If you input a calculation, R will return the result of that calculation.

You can also use parentheses as you would on a normal scientific calculator:

```{r}
10*3+4
10*(3+4)
```

You have now learned how R can be used as a calculator!

### Text input {#textinput}

If you input text into the console, however, you will get the following:

```{r, error = TRUE}
hello
```

The error message reason for this will be apparent later in this tutorial. To get R to return text, you have to enclose the text in single or double quotes (`"` or `'`) like so:

```{r}
"hello"
'hello'
```

::: {.green}
**Important concept:** To make R interpret what you write as text, you have to enclose it with single or double quotes:

-   `"hello"` or `'hello'` rather than just `hello`
:::

### Comments

If you input a `#`, R will ignore whatever comes after on the same line. This means you can write entire lines of comments, or write comments after your calculations:

```{r, eval = FALSE}
# This entire line is a comment, and that is fine!

6 + 4 # add a meaningful comment on why you're doing this
```

Comment your code liberally, so it becomes easier to understand for any person reading your code. That person is often your future self, and you'd be surprised to learn how unreadable uncommented code can be, even if you wrote it yourself! Fortunately, you will never end up in that situation, since from now on you will be commenting everything you do (because I said so).

### Some additional tips about the console

-   use the up and down arrows to cycle through your previous commands
-   if the `>` in the console turns into a `+`, it means that you probably forgot to close a parenthesis or a quote (try e.g. running `"hello`). You will be unable to do anything while the console is behaving like this. Press the `Esc` button to get your familiar `>` back and continue working.

## Scripts

Doing small operations in the console is all well and good, but once you've done something a bit more complex than adding numbers you will want to save what you did in some way. You could use the up-arrow in the console to recall the things you did (even if you close and reopen RStudio), but imagine if the thing you want to recall was a thousand operations ago. That's a whole lot of button pressing! The most convenient way to store what you have done in R is by writing a script.

A script in R is just a text document containing R code, and the file extension is .R (your script can e.g. be called "myscript.R". In RStudio, you can create a new script either from the menu `File > New File > R script` or by pressing `ctrl`+`shift`+`N` on Windows or `command`+`shift`+`N` on Mac.

Working in a script is almost exactly the same as working in the console: You write a line of code in the script, run it, and the result is shown in the console. The main difference is that you have to press `ctrl`/`command`+`enter` to run code from a script, rather than just `enter`. The other big difference is that you can save your scripts, so you have access to all the code you have previously written. For this reason, you should always work in a script rather than in the console.

**Exercise: Create a new script, and save it with a meaningful name (e.g. "BIOS1140_week01.R" in a folder named BIOS1140). Run the commands you ran in the console earlier, but this time from your script instead. Remember to comment your code with `#` as you go along!**

::: {.green}
Whenever you start a new project, create a script for that project. Save your script in a meaningful location with a meaningful name so it will be easy to find later.
:::

# R essentials

In this part of the tutorial, we will learn the fundamentals of R programming, while investigating the demographics of the Nordic countries. All numbers are the 2020 populations taken from the [International Data Base (IDB)](https://www.census.gov/data-tools/demo/idb/#/table) from the US government.

## Assigning to objects

### Problem: numbers are complicated

Let's start by looking at Norway and Sweden. Say you want to find out what proportion the Norwegian population makes up of the total population of Norway plus Sweden. Conceptually, it looks something like this:

$$\frac{Norwegian\ population}{Norwegian\ population+Swedish\ population}$$

**Exercise: The Norwegian population is 5 465 387 and the Swedish is 10 185 555. Use R to calculate the proportion the Norwegian population makes up of the total population. Do the same for the Swedish population.**

------------------------------------------------------------------------

If you were able to do this, great work! Your solution probably looked something like this[^1]:

[^1]: with the comments, I hope!

```{r, eval = FALSE}
# Norwegian population
5465387 / (5456387 + 10185555)
# Swedish population
10185555 / (5465387 + 10185555)
```

However, there are several problems with doing it this way. First of all, 5465387 is a stupidly long number, and the probability of typing it wrong is rather high (I actually mistyped a number in the code above, can you spot the error?). Another problem is that if any of the populations change (e.g. you want to update to 2021 numbers), you would have to update it in **four different places** to make this simple change. Third: for someone looking at your code, how will they know what's happening? These numbers have no meaning without their context.

Now we're finally getting to the first taste of why R is more powerful than a regular calculator: we can give our numbers simple names.

### Solution: assign the complicated numbers to named objects

What if you could write some text instead of our stupidly large numbers? Something like `norway_pop` instead of 5465387? Luckily, you can! You can do the following to give your variables a name:

```{r}
# store the number to an object called norway_pop
norway_pop <- 5465387
# store another number to an object called sweden_pop
sweden_pop <- 10185555
```

This is called assignment, and is done using the arrow `<-`[^2]. You have now created a named object, which is a very powerful tool. Your objects behave exactly like the numbers that are stored in them (try e.g. `norway_pop*2` or `sweden_pop+4445`). This means that we can now simply write:

[^2]: You can also use `=` instead of `<-` . If you know another programming language already, like Python, this may feel more natural. I like to use the arrow to remind my muscle memory that I'm working in R, but it makes absolutely no difference which you use, so use whichever you like!

```{r}
norway_pop / (norway_pop + sweden_pop)
sweden_pop / (norway_pop + sweden_pop)
```

This is much simpler, easier to read and way less error-prone than writing out the numbers each time. In addition, if you want to change any of the population sizes, you will just have to change it in one place instead of four.

To make things even easier, we could store `norway_pop + sweden_pop` as `total_pop`, and also store our results with a name as well:

```{r}
# make total population object
total_pop <- norway_pop + sweden_pop

# make object for Norway's proportion
norway_proportion <- norway_pop / total_pop
# print the result
norway_proportion

# make object for Sweden's population
sweden_proportion <- sweden_pop / total_pop
# print the result
sweden_proportion
```

::: {.blue}
**Additional info**\
If you have experience with Python, you would have printed the objects using `print(norway_proportion)`. In R we don't have to explicitly use `print()`, an object (or any calculation for that matter) is automatically printed when we run it. R does have a `print()` function, though, that can be used if you want to be explicit about printing something.
:::

### Notes about naming variables

You should always give your variables sensible names. In the code above, we could have saved ourselves some typing by e.g. calling the populations `x` and `y` respectively. However, this quickly becomes a nightmare to read when scripts get long, so even though `norway_pop` takes longer to write than `x`, you should go with `norway_pop` so it's possible to understand what's going on in your script.

You can name your variables just about anything, but there are some characters you can't use in their names. Notably, spaces, dashes and a lot of special characters cant' be used, and the name cannot start with a number. If you stick to letters, underscores and numbers (except in the beginning), you should be fine!

Another thing to note about variable names is that they are case sensitive, for instance meaning that `A` can contain something completely different than `a`. In the code above, we used all-lowercase variable names, so what happens if we try to run the object `Norway_pop`[^3]?

[^3]: As a side note, whenever you wonder "what happens if I do ...", try it! The worst thing that can happen if you try something is that you get an error, the best thing is that you learn something useful.

```{r, error = TRUE}
Norway_pop
```

R can't find `Norway_pop`, because it doesn't exist, only `norway_pop` does. Beware of this, as it's often a source of annoying bugs in the code.

::: {.green}
Assign any and all variables to named objects. It's easier to read, and you're less likely to make mistakes. Use good variable names, and beware of case sensitivity!
:::

## Vectors

Let's expand our little Norway-Sweden project to all the Nordic countries. Table \@ref(tab:nordpop) shows the populations of all the Nordic countries.

```{r nordpop, echo = FALSE}
nordic_tab <- read.csv("nordic_data.csv")

knitr::kable(nordic_tab[order(nordic_tab$Country.Area.Name),c("Country.Area.Name", "Population")], col.names = c("Country", "Population"), row.names = FALSE)

```

**Exercise: Do the same with all the Nordic countries that you did with Norway and Sweden. Assign each population size to an object and calculate their proportion of the total Nordic population**

------------------------------------------------------------------------

### Problem: too many objects gets complicated

If you solved the exercise above, you're probably tired from writing almost the same thing over and over. My solution looks something like this:

```{r}
denmark_pop <- 5868927
finland_pop <- 5572355
iceland_pop <- 350773
nordic_total <-  norway_pop + sweden_pop + denmark_pop + finland_pop + iceland_pop

norway_proportion <- norway_pop / nordic_total

sweden_proportion <- sweden_pop / nordic_total

denmark_proportion <- denmark_pop / nordic_total

finland_proportion <- finland_pop / nordic_total

iceland_proportion <- iceland_pop / nordic_total

norway_proportion
sweden_proportion
denmark_proportion
finland_proportion
iceland_proportion
```

That is a lot of typing! And remember that this is only for the Nordic countries, imagine doing this for all the countries in the world! Surely there has to be simpler solution? Luckily, there is.

### Solution: Store it in a vector!

R has a data type called vector, which can store multiple values at once. In our case, this means that we can store the populations of all the Nordic countries in one vector. Let's look at some different ways to make a vector. The following lines all create a vector containing the numbers 1 through 10.

```{r, eval=FALSE}
# create a vector with c()
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)

# create a vector with :
1:10

# create a vector with seq()
seq(from = 1, to = 10, by = 1)

```

1.  You can create a vector manually with `c()`. All your numbers (or other values) go inside the parentheses, separated by comma.
2.  You can create a vector with the colon operator `:`. This creates a vector containing all the numbers starting from the number before `:`, and up to and including the number after.
3.  You can create a vector with `seq()`. The numbers go inside the parentheses, separated by comma. The number after `from =` is the beginning of the vector, after `to =` is the end of the vector, and after `by =` is the distance between the values in the vector.

As a side note, `c()` and `seq()` are what we call functions. We'll get back to functions shortly, so don't worry if you don't fully understand how these work yet.

Like numbers, vectors can be assigned to objects. This works in exactly the same way, using the arrow `<-`.

```{r}
arbitrary_numbers <- c(56, 789, 109, 76)
arbitrary_numbers

my_sequence <- seq(from = 0, to = 60, by = 5)
my_sequence
```

**Exercise: Store the population sizes of the Nordic countries in a vector using `c()`. Input the numbers in alphabetical order of the countries (same as in table** \@ref(tab:nordpop) **above) Assign the vector to an object with a good name.**

------------------------------------------------------------------------

**Solution to the exercise:**

```{r}
nordic <- c(5868927, 5572355, 350773, 5465387, 10185555)
```

### Vector properties

#### Mathematical operations

When you have a vector of numbers, you can apply all the same mathematical operations that you can on a single number. The operation is then applied to each element of the vector separately. Try it!

```{r}
# create a vector from 1 to 10
my_vector <- 1:10

# multiply each element by 2
my_vector * 2

# add 5 to each element
my_vector + 5
```

If you have two vectors of equal length, you can do mathematical operations on both, e.g. multiply two vectors. The first element of the first vector is then multiplied with the first element of the second vector, the second element with the second and so on. You can do the same for division, addition, subtraction and any operation you can think of.

```{r}
# create another vector
my_vector2 <- 11:20

# mutliply them together
my_vector * my_vector2

# add them
my_vector + my_vector2
```

If the two vectors aren't of the same length, you will get a warning, but R will still try to perform the operation. The shorter vector will then start over when it runs out of numbers.

```{r}
# multiplying two vectors of unequal length
1:10 * 1:9

# this is what R does:
#1*1
#2*2
#3*3
#4*4
#5*5
#6*6
#7*7
#8*8
#9*9 # here we use the last element of the vector 1:9
#10*1 # here R "recycles" the vector, using the first element of 1:9
```

Don't worry if you don't quite understand what happens when the two vectors are of unequal length. For now, just remember to keep all your vectors the same length, or something unexpected might happen!

#### Extracting numbers

Having all numbers stored in one place is great, but what if you want to use just one of them? We use square brackets `[]` to access numbers inside vectors. You put the index of the element you want to extract inside the square brackets like this: `my_vector[1]`. This will extract the first element from the vector, `my_vector[2]` will extract the second. On our `nordic` vector, we could for instance do the following:

```{r}
# extract the third element (Iceland) from the nordic vector
nordic[3]
```

We can also select multiple numbers, by inputting a vector inside the square brackets. `nordic[c(3, 5)] will extract the third and the fifth element of our `nordic` vector, and `nordic[1:3]` will extract elements 1 through 3.

**Exercise: extract elements 2 through 4 from the `nordic` vector. Then, extract only the scandinavian countries, and store them in an object with a good name.**


